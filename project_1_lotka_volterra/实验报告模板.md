# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** 刁正勇 
**学号：**20231050165
**完成日期：**2025.5.28 
**实验时间：**40min

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

```
### 数学形式
Lotka - Volterra方程组是描述捕食者 - 猎物关系的经典模型，由两个耦合的一阶非线性微分方程组成：
设\(x(t)\)代表时刻\(t\)时猎物的数量 ；\(y(t)\)代表同一时刻捕食者的数量，则方程组为：
\(\frac{dx}{dt} = \alpha x - \beta xy\)
\(\frac{dy}{dt} = \delta xy - \gamma y\)

### 各参数生物学意义
- **\(\alpha\)（正实数）**：猎物自然增长率。表示在没有捕食者存在时，猎物数量随时间的增长速率，反映猎物自身繁殖能力 。
- **\(\beta\)（正实数）**：捕食导致的猎物死亡率。体现捕食者对猎物捕杀作用的强度，即每一个捕食者在单位时间内捕杀猎物的比例 。
- **\(\gamma\)（正实数）**：捕食者因其他原因（如衰老、疾病等非捕食因素 ）造成的自然死亡率。代表在没有猎物可捕食时，捕食者数量随时间的减少速率。 
- **\(\delta\)（正实数）**：因食用猎物而增加的捕食者增长速率。表示每捕食一定数量猎物，捕食者种群数量的增长程度 。 

### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**
```
基本思想是基于导数的定义，用当前点的斜率来近似下一点的函数值。对于常微分方程\(\frac{dy}{dt}=f(t,y)\)，在一个时间步长h内，认为斜率\(f(t,y)\)不变。公式为\(y_{n + 1}=y_{n}+h\cdot f(t_{n},y_{n})\) ，其中\(y_{n}\)是当前时刻\(t_{n}\)的函数值，\(y_{n + 1}\)是下一时刻\(t_{n+1}=t_{n}+h\)的函数值，h是时间步长，\(f(t_{n},y_{n})\)是\(t_{n}\)时刻的导数 。

**改进欧拉法：**
```
改进之处在于对欧拉法的修正。欧拉法仅用起点斜率预估下一点值，误差较大。改进欧拉法采用 “预测 - 校正” 策略 。先使用欧拉法得到一个预测值\(\tilde{y}_{n + 1}=y_{n}+h\cdot f(t_{n},y_{n})\) ，再计算预测点\((t_{n + 1},\tilde{y}_{n + 1})\)处的斜率\(f(t_{n + 1},\tilde{y}_{n + 1})\) ，最后取起点和预测点处斜率的平均值来计算下一点的值，即\(y_{n + 1}=y_{n}+\frac{h}{2}[f(t_{n},y_{n})+f(t_{n + 1},\tilde{y}_{n + 1})]\) ，提高了精度，是二阶方法。

**4阶龙格-库塔法：**
```
优势在于精度高，是一种广泛应用的求解常微分方程的数值方法。它通过在一个时间步长内计算多个不同点的斜率（\(k_1,k_2,k_3,k_4\) ），并对这些斜率进行加权平均来近似准确的斜率，从而得到更精确的函数值。相比低阶方法，它能以相对适中的计算量获得较高精度，在相同步长下误差比欧拉法和改进欧拉法小得多，能更准确地模拟系统随时间的演化，适用于对精度要求较高的场景 。

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：
 Lotka-Volterra 方程组定义（核心模型）
def lotka_volterra_system(state: np.ndarray, t: float, alpha: float, beta: float,
                          gamma: float, delta: float) -> np.ndarray:
    """定义捕食者-猎物系统的微分方程组"""
    x, y = state  # x=猎物数量, y=捕食者数量
    dxdt = alpha * x - beta * x * y  # 猎物变化率：自然增长 - 被捕食损失
    dydt = gamma * x * y - delta * y  # 捕食者变化率：捕食增长 - 自然死亡
    return np.array([dxdt, dydt])

    4 阶龙格 - 库塔法（核心求解器）
    def runge_kutta_4(f, y0: np.ndarray, t_span: Tuple[float, float],
                  dt: float, *args) -> Tuple[np.ndarray, np.ndarray]:
    """4阶龙格-库塔法求解常微分方程"""
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)  # 生成时间序列
    n_steps = len(t)
    y = np.zeros((n_steps, len(y0)))  # 存储解的数组
    y[0] = y0  # 初始条件

    for i in range(n_steps - 1):
        h = dt
        yi = y[i]
        ti = t[i]
        
        # 计算4个龙格-库塔系数
        k1 = h * f(yi, ti, *args)
        k2 = h * f(yi + k1/2, ti + h/2, *args)
        k3 = h * f(yi + k2/2, ti + h/2, *args)
        k4 = h * f(yi + k3, ti + h, *args)
        
        # 加权平均更新下一时间步的解
        y[i+1] = yi + (k1 + 2*k2 + 2*k3 + k4) / 6

    return t, y
### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：
### **1. 数值方法精度不足导致结果振荡**
**问题**：  
使用欧拉法时，发现猎物和捕食者数量随时间演化出现明显振荡甚至发散，尤其在步长较大时（如`dt=0.1`），相空间轨迹无法闭合，与理论上的周期性轨道不符。  
**原因**：  
欧拉法为一阶方法，局部截断误差为\(O(h^2)\)，对刚性系统（如捕食者-猎物模型的强耦合关系）稳定性差，累积误差显著。  

**解决方法**：  
- **改用高阶方法**：采用4阶龙格-库塔法（RK4），其局部截断误差为\(O(h^5)\)，显著提升精度。即使在较大步长下（如`dt=0.1`），相空间轨迹仍能保持闭合，符合理论预期。  
- **减小步长**：对欧拉法和改进欧拉法，通过减小步长（如`dt=0.01`）降低误差，但计算效率较低（需更多迭代步骤）。  
## **2. 参数符号与模型物理意义不符**  
**问题**：  
初始代码中捕食者增长率项符号错误（如`dydt = -gamma * x * y - delta * y`），导致捕食者数量随猎物增加而减少，违背生物学逻辑。  
**原因**：  
对Lotka-Volterra方程中参数符号的理解偏差：捕食者应通过捕食猎物增长（正项），而非减少。  

**解决方法**：  
- **修正方程符号**：确保捕食者增长率为`gamma * x * y`（猎物数量\(x\)与捕食者数量\(y\)的乘积项为正），自然死亡率为`-delta * y`  

- **验证初始条件**：通过简单测试用例（如`x=1, y=1, gamma=0.5, delta=2`），确保`dydt`在猎物充足时为正，猎物不足时为负。  
### **3. 不同初始条件下的轨迹重复性问题**  
**问题**：  
改变初始种群数量（如`x0=1, y0=3`或`x0=3, y0=1`）时，相空间轨迹形状差异大，部分轨迹出现非周期性波动。  
**原因**：  
Lotka-Volterra模型理论上具有周期性，但对初始条件敏感，不同初始值会导致不同振幅的周期解，而非唯一轨道。  

**解决方法**：  
- **理论分析结合可视化**：通过绘制多组初始条件下的时间序列和相图（如`analyze_parameters`函数），确认轨迹差异是模型特性（周期解的振幅依赖初始条件），而非代码错误。  
- **引入守恒量验证**：计算系统的守恒量\(H = \gamma x + \beta y - \delta \ln x - \alpha \ln y\)，发现其在数值解中保持恒定（如图4所示），验证解的正确性。  
### **4. 多方法比较时的计算效率问题**  
**问题**：  
改进欧拉法与欧拉法在相同步长下计算耗时相近，但精度提升有限；RK4法计算耗时约为欧拉法的4倍（因每次迭代需计算4次斜率）。  
**原因**：  
RK4法的计算复杂度较高，但精度优势显著；改进欧拉法虽为二阶方法，但“预测-校正”步骤未显著增加计算量。  

**解决方法**：  
- **按需选择方法**：  
  - 对精度要求低、计算资源有限的场景，使用欧拉法（如初步调试）。  
  - 对精度要求高的正式模拟，优先使用RK4法（如主函数中的默认配置）。  
- **向量化优化**：利用NumPy数组运算替代循环，提升所有方法的计算效率（如`runge_kutta_4`中用数组存储多变量状态）。  
## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：

```![image](https://github.com/user-attachments/assets/ec1f0a0e-b445-488e-b952-352340ff5e2b)

图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹
```

**观察结果描述：**
从图中可观察到：
 - **周期性**：猎物和捕食者数量均呈周期性变化，且周期相近。
 - **相位关系**：猎物数量先于捕食者达到峰值，捕食者数量变化滞后于猎物。
 - **初始条件影响**：不同初始条件下，数量波动幅度不同，但周期基本不变。
 - **能量守恒**：虽有波动，但整体上守恒量相对稳定。 

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：
![image](https://github.com/user-attachments/assets/a60be2bd-4c52-40ea-9032-a6048dc1056c)


图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```

**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法 | 低，时间序列波动大，相空间轨迹偏离理论轨道 | 高，计算步骤简单 | 差，随时间累积误差易致结果发散 | 大，守恒量偏离理论值明显|
| 改进欧拉法 | 中，较欧拉法波动减小，相空间轨迹更接近理论 | 较高，略低于欧拉法| 较好，比欧拉法更稳定 | 较小，守恒量偏离程度降低|
| 4阶RK法 | 高，时间序列平滑，相空间轨迹接近理论闭合曲线 | 低，单次迭代计算量较大 | 好，能准确模拟系统周期变化 | 小，守恒量更接近理论恒定值 |

### 4.3 参数影响分析

请在此处粘贴不同初始条件下的结果图：

```
![image](https://github.com/user-attachments/assets/5a8e696e-3686-42e9-81bc-ce7042d0f1cd)

图4.3: 不同初始条件的影响
```

**参数敏感性分析：**
```
### 数量波动幅度
 - 不同颜色曲线代表不同初始条件，猎物和捕食者数量波动幅度差异明显。如\(x0 = 3, y0 = 1\)（绿色曲线）的猎物数量峰值高于其他初始条件，\(x0 = 1, y0 = 3\)（红色曲线）的捕食者数量峰值也相对突出 。说明初始数量会影响种群数量波动的最大最小值。
### 相空间轨迹
 - 相空间中不同初始条件对应不同大小和形状的闭合曲线。初始条件不同，轨迹的位置和范围有别，但均为闭合曲线，表明系统具有周期性 ，只是周期内的具体变化路径和振幅因初始条件而异。
### 对守恒量的影响
 - 能量守恒测试图显示，虽守恒量在不同初始条件下均有波动，但整体波动范围相对稳定 ，说明初始条件主要改变种群数量变化特征，对系统守恒特性的本质影响较小。 
```

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
猎物和捕食者数量呈现周期性变化。当猎物数量充足时，捕食者因食物丰富而数量增加；捕食者数量增多导致猎物被捕食压力增大，数量开始下降；猎物减少后，捕食者因食物短缺数量也随之减少；捕食者数量减少又使得猎物被捕食压力降低，数量再次回升，从而形成一个循环。

**相互作用机制：**
```
捕食者与猎物之间存在明显的相位差。猎物数量达到峰值后，捕食者数量才会逐渐达到峰值，这是因为捕食者数量的增长依赖于猎物数量的积累。而当猎物数量开始下降后，捕食者数量由于惯性仍会维持在较高水平一段时间，之后才随着食物的减少而下降，表现出明显的滞后效应。
生态平衡：

**生态平衡：**
```
系统具有一定的稳定性，在没有外界干扰的情况下，能够维持周期性的波动。这种平衡状态是动态的，依赖于捕食者和猎物之间的相互制约关系。当外界因素如环境变化、天敌引入等打破这种平衡时，系统可能需要一定时间重新调整到新的平衡状态，或者可能导致种群数量的大幅波动甚至灭绝。


### 5.2 数值方法评估

**精度比较：**
4 阶龙格 - 库塔法（RK4）精度最高，其在时间序列图上波动小，相空间轨迹接近理论闭合曲线，能准确模拟系统周期性。改进欧拉法精度次之，相较于欧拉法，时间序列波动减小，相空间轨迹更接近理论。欧拉法精度最低，时间序列波动大，相空间轨迹偏离理论轨道明显。原因在于 RK4 法是四阶方法，通过多个斜率加权平均近似准确斜率；改进欧拉法是二阶方法，采用 “预测 - 校正” 策略提高精度；欧拉法是一阶方法，仅用当前点斜率预估下一点，误差累积大。
计算效率：

**计算效率：**
欧拉法计算效率最高，其迭代公式简单，每次迭代计算量小，计算时间短，资源消耗少。改进欧拉法计算效率次之，虽增加了 “预测 - 校正” 步骤，但计算量增加相对有限。4 阶龙格 - 库塔法计算效率最低，每次迭代需计算 4 个斜率，计算量约为欧拉法的 4 倍，计算时间长，资源消耗大。

**适用性分析：**
对精度要求不高，计算资源有限且系统变化相对平缓：可选择欧拉法，例如在初步探索模型、对结果精度要求低的模拟场景中。
对精度有一定要求，计算资源适中：改进欧拉法较为合适，适用于一般精度要求的常规模拟场景。
对精度要求极高，计算资源充足，系统复杂且需要准确模拟：应选择 4 阶龙格 - 库塔法，如对复杂生态系统长期动态变化的精确模拟等场景 。

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
### 为什么Lotka-Volterra系统会表现出周期性行为
Lotka-Volterra系统基于两个物种（捕食者和猎物）间的相互作用构建。从数学模型看，其方程组包含体现物种自然增长、被捕食影响等因素的项。当猎物数量较多时，捕食者因食物充足，繁殖机会增加，数量随之上升；捕食者增多后，对猎物的捕食压力增大，导致猎物数量下降；猎物减少又使捕食者因食物匮乏数量降低；捕食者减少后，猎物受捕食压力减小，数量再次回升 ，如此循环往复，呈现周期性波动。从稳定性分析角度，系统存在稳定平衡点，当种群数量偏离平衡点时，会在平衡点附近做有规律的震荡，表现为周期性 。

### 这种周期性在现实生态系统中是否存在
现实生态系统中存在类似周期性。例如雪兔和猞猁的种群数量，通过对加拿大hudsonbay皮草贸易公司交易数据的分析发现，在较长时间尺度上呈现出规则的周期变化 ，雪兔数量先增加，猞猁因食物充足随后数量上升，接着雪兔因被捕食压力增大数量下降，猞猁又因食物减少数量降低，符合Lotka-Volterra模型描述的规律。不过，现实生态系统更为复杂，Lotka-Volterra模型基于恒定环境、无限资源等简化假设，实际中环境会变化，资源有限且存在其他物种竞争、疾病等因素干扰，可能使周期性不完全规则，甚至被打破 ，但在一些相对简单、稳定的生态子系统中，周期性仍较为明显。 



**实验报告完成情况自评：**

- [ √] 完成了所有必需的函数实现
- [ √ ] 通过了所有测试用例
- [  √] 生成了所有要求的图表
- [ √ ] 完成了结果分析和讨论
- [ √ ] 回答了所有思考题

**总体评价：** 整体完成较好。

**建议成绩：**100分 / 100分
